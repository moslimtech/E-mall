<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù…ÙˆÙ„Ø¯ Ø§Ù„ÙÙˆØ§ØªÙŠØ± ÙˆØ¹Ø±ÙˆØ¶ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
  <style>
    body { font-family: "Tahoma", sans-serif; background:#f7f7f7; padding:20px; }
    h2 { text-align:center; }
    table { width:100%; border-collapse: collapse; margin-top:10px; background:#fff; }
    table, th, td { border:1px solid #ccc; }
    th, td { padding:8px; text-align:center; }
    .btn { padding:10px 20px; margin:10px; cursor:pointer; border:none; border-radius:5px; }
    .add { background:#4CAF50; color:#fff; }
    .pdf { background:#2196F3; color:#fff; }
    #invoice { background:#fff; padding:15px; border-radius:10px; }
  </style>
</head>
<body>

  <h2>ğŸ§¾ Ù…ÙˆÙ„Ø¯ Ø§Ù„ÙÙˆØ§ØªÙŠØ± ÙˆØ¹Ø±ÙˆØ¶ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</h2>

  <label>Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹: </label>
  <select id="docType">
    <option value="ÙØ§ØªÙˆØ±Ø©">ÙØ§ØªÙˆØ±Ø©</option>
    <option value="Ø¹Ø±Ø¶ Ø£Ø³Ø¹Ø§Ø±">Ø¹Ø±Ø¶ Ø£Ø³Ø¹Ø§Ø±</option>
  </select>

  <br><br>
  <label>Ø§Ø³Ù… Ø§Ù„ØªØ§Ø¬Ø±/Ø§Ù„Ù…Ø­Ù„: </label>
  <input type="text" id="merchant" placeholder="Ù…Ø«Ø§Ù„: Ø´Ø±ÙƒØ© Ù…Ø³Ù„Ù… ØªÙƒ">

  <div id="invoice">
    <h3 id="invoiceTitle">ÙØ§ØªÙˆØ±Ø©</h3>
    <p id="merchantName">Ø§Ù„ØªØ§Ø¬Ø±: Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…</p>

    <table id="itemsTable">
      <tr>
        <th>Ø§Ù„ØµÙ†Ù</th>
        <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
        <th>Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©</th>
        <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
        <th>âœ–</th>
      </tr>
    </table>

    <h3>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: <span id="total">0</span> Ø¬.Ù…</h3>
  </div>

  <button class="btn add" onclick="addRow()">â• Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù</button>
  <button class="btn pdf" onclick="generatePDF()">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ PDF</button>

  <script>
    function addRow() {
      let table = document.getElementById("itemsTable");
      let row = table.insertRow();
      row.innerHTML = `
        <td><input type="text" placeholder="Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù" oninput="updateInvoice()"></td>
        <td><input type="number" value="1" oninput="calcTotal()"></td>
        <td><input type="number" value="0" oninput="calcTotal()"></td>
        <td class="rowTotal">0</td>
        <td><button onclick="this.parentElement.parentElement.remove();calcTotal();">âœ–</button></td>
      `;
    }

    function calcTotal() {
      let table = document.getElementById("itemsTable");
      let rows = table.rows;
      let grandTotal = 0;
      for (let i = 1; i < rows.length; i++) {
        let qty = rows[i].cells[1].children[0].value || 0;
        let price = rows[i].cells[2].children[0].value || 0;
        let rowTotal = qty * price;
        rows[i].cells[3].innerText = rowTotal;
        grandTotal += rowTotal;
      }
      document.getElementById("total").innerText = grandTotal;
      updateInvoice();
    }

    function updateInvoice() {
      let type = document.getElementById("docType").value;
      let merchant = document.getElementById("merchant").value || "Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…";
      document.getElementById("invoiceTitle").innerText = type;
      document.getElementById("merchantName").innerText = "Ø§Ù„ØªØ§Ø¬Ø±: " + merchant;
    }

    function generatePDF() {
      const element = document.getElementById("invoice");
      html2pdf().set({
        margin: 10,
        filename: document.getElementById("docType").value + '.pdf',
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      }).from(element).save();
    }
  </script>

</body>
</html>
